<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>çŒœæ‹³è´é£¯æ²éŠæˆ²</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: #fffaf2;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .game-wrapper {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      width: 1000px;
      max-width: 100%;
    }
    .side-panel {
      width: 180px;
      background-color: #fff3d1;
      border-radius: 10px;
      padding: 10px;
      height: 360px;
      box-sizing: border-box;
      font-size: 1em;
      overflow-y: auto;
      user-select: none;
    }
    .side-panel h3 {
      text-align: center;
      margin-top: 0;
    }
    .game-container {
      background-color: #ffffff;
      border-radius: 15px;
      padding: 20px;
      width: 640px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      user-select: none;
    }
    .computer {
      font-size: 48px;
      margin-bottom: 8px;
      user-select: none;
    }
    .riceball-info {
      font-size: 1.2em;
      margin: 15px;
      padding: 10px;
      background: #ffe5b4;
      border-radius: 10px;
      text-align: center;
      user-select: none;
    }
    .vs-section {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 20px 0;
      height: 100px;
      user-select: none;
    }
    .hand {
      font-size: 60px;
      width: 100px;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
    }
    .result {
      font-size: 1.3em;
      margin: 10px;
      font-weight: bold;
      user-select: none;
    }
    .final {
      font-size: 2em;
      margin-top: 10px;
      user-select: none;
    }
    #restartBtn {
      display: none;
      padding: 10px 20px;
      font-size: 1em;
      margin-top: 10px;
      background-color: #aaffcc;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s;
    }
    #restartBtn:hover {
      background-color: #88d6b4;
    }
    .choices {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
      user-select: none;
    }
    .choices button {
      font-size: 1.8em;
      padding: 10px;
      background-color: #ffd58f;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.2s;
      user-select: none;
    }
    .choices button:hover:not(:disabled) {
      background-color: #ffc777;
    }
    .choices button:disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }
    .list {
      list-style: none;
      padding-left: 10px;
      user-select: none;
    }
    .list li {
      margin: 6px 0;
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <div class="side-panel">
      <h3>ä½ çš„é£¯æ²</h3>
      <ul class="list" id="playerRollsList"><li>ç„¡</li></ul>
    </div>

    <div class="game-container">
      <div class="computer">ğŸ–¥ï¸</div>
      <div class="riceball-info" id="currentRiceball">ğŸ² æœ¬å±€å¯ç²å¾—çš„é£¯æ²æ˜¯...</div>

      <div class="vs-section">
        <div class="hand" id="playerHand">âœŠ</div>
        <div class="hand" id="computerHand">âœŠ</div>
      </div>

      <div class="result" id="resultText">è«‹å‡ºæ‹³æˆ–ä½¿ç”¨æ…¢å‡ºæŠ€å·§</div>
      <div class="final" id="finalResult"></div>
      <button id="restartBtn" onclick="resetGame()">å†ç©ä¸€æ¬¡</button>

      <div class="choices">
        <button id="btnScissors" onclick="handlePlayerMove('å‰ªåˆ€', false)">âœŒ</button>
        <button id="btnRock" onclick="handlePlayerMove('çŸ³é ­', false)">âœŠ</button>
        <button id="btnPaper" onclick="handlePlayerMove('å¸ƒ', false)">âœ‹</button>
        <button id="btnSlow" onclick="handlePlayerMove('æ…¢å‡º', true)">ğŸ¢ æ…¢å‡º</button>
      </div>
    </div>

    <div class="side-panel">
      <h3>é›»è…¦çš„é£¯æ²</h3>
      <ul class="list" id="computerRollsList"><li>ç„¡</li></ul>
    </div>
  </div>

  <script>
    const moves = ["å‰ªåˆ€", "çŸ³é ­", "å¸ƒ"];
    const icons = { "å‰ªåˆ€": "âœŒ", "çŸ³é ­": "âœŠ", "å¸ƒ": "âœ‹" };
    const riceBallsAll = ["å¾·å¼é¦™è…¸", "å¡å•¦é›", "ç´ ä¸‰è‰²", "æ·±æµ·é®ªé­š", "åŸ¹æ ¹è›‹"];
    let playerRolls = [];
    let computerRolls = [];
    let currentRiceball = "";
    let gameInProgress = false;

    function getAvailableRiceballs() {
      // åªèƒ½ç§»é™¤é›™æ–¹éƒ½æ“æœ‰çš„å£å‘³
      return riceBallsAll.filter(rb => !(playerRolls.includes(rb) && computerRolls.includes(rb)));
    }

    function showNextRiceball() {
      const available = getAvailableRiceballs();
      if (available.length === 0) {
        document.getElementById("currentRiceball").textContent = "ğŸ¥¢ ç„¡æ›´å¤šé£¯æ²å¯ç²å¾—";
        return;
      }
      currentRiceball = available[Math.floor(Math.random() * available.length)];
      document.getElementById("currentRiceball").textContent = `ğŸ² æœ¬å±€å¯ç²å¾—çš„é£¯æ²ï¼šã€Œ${currentRiceball}ã€`;
    }

    function updateRolls() {
      const playerList = document.getElementById("playerRollsList");
      const computerList = document.getElementById("computerRollsList");
      playerList.innerHTML = playerRolls.length
        ? playerRolls.map(r => `<li>ğŸ™ ${r}</li>`).join("")
        : "<li>ç„¡</li>";
      computerList.innerHTML = computerRolls.length
        ? computerRolls.map(r => `<li>ğŸ™ ${r}</li>`).join("")
        : "<li>ç„¡</li>";
    }

    function disableButtons(state) {
      document.getElementById("btnScissors").disabled = state;
      document.getElementById("btnRock").disabled = state;
      document.getElementById("btnPaper").disabled = state;
      document.getElementById("btnSlow").disabled = state;
    }

    function handlePlayerMove(playerMove, isCheating) {
      if (gameInProgress) return; // é¿å…é‡è¤‡é»æ“Š
      if (playerRolls.length === 5 || computerRolls.length === 5) return;

      gameInProgress = true;
      disableButtons(true);

      // å°æ±ºé–‹å§‹ï¼Œå…ˆé›™æ–¹éƒ½æ¡æ‹³
      document.getElementById("playerHand").textContent = "âœŠ";
      document.getElementById("computerHand").textContent = "âœŠ";
      document.getElementById("resultText").textContent = "æ€è€ƒä¸­...";

      setTimeout(() => {
        if (isCheating) {
          // æ…¢å‡ºæ¨¡å¼ï¼Œæœ‰ 30% æ©Ÿç‡è¢«æŠ“
          const caught = Math.random() < 0.3;
          if (caught) {
            alert("ä½ è¢«é›»è…¦ç™¼ç¾æ…¢å‡ºäº†ï¼ä½ çš„é£¯æ²è¢«æ²’æ”¶ï¼");
            playerRolls = [];
            updateRolls();
            showNextRiceball();
            document.getElementById("resultText").textContent = "è¢«æŠ“æ¸…ç©ºé£¯æ²ï¼è«‹é‡æ–°å‡ºæ‹³ã€‚";
            gameInProgress = false;
            disableButtons(false);
            return;
          } else {
            // æ…¢å‡ºå¿…å‹
            playerWin(currentRiceball);
            gameInProgress = false;
            disableButtons(false);
            return;
          }
        }

        // æ­£å¸¸å‡ºæ‹³ï¼Œé›»è…¦éš¨æ©Ÿ
        const computerMove = moves[Math.floor(Math.random() * moves.length)];
        const playerIcon = icons[playerMove];
        const computerIcon = icons[computerMove];

        // æ­æ›‰é›™æ–¹å‡ºæ‹³
        document.getElementById("playerHand").textContent = playerIcon;
        document.getElementById("computerHand").textContent = computerIcon;

        // åˆ¤å®šå‹è² 
        if (playerMove === computerMove) {
          document.getElementById("resultText").textContent = "å¹³æ‰‹ï¼";
          // å¹³æ‰‹ä¸æ›é£¯æ²ï¼Œä¿ç•™æœ¬å±€é£¯æ²
        } else if (
          (playerMove === "å‰ªåˆ€" && computerMove === "å¸ƒ") ||
          (playerMove === "çŸ³é ­" && computerMove === "å‰ªåˆ€") ||
          (playerMove === "å¸ƒ" && computerMove === "çŸ³é ­")
        ) {
          playerWin(currentRiceball);
        } else {
          computerWin(currentRiceball);
        }
        gameInProgress = false;
        disableButtons(false);
      }, 1500);
    }

    function playerWin(riceball) {
      if (!playerRolls.includes(riceball)) playerRolls.push(riceball);
      document.getElementById("resultText").textContent = `ä½ è´äº†ï¼ç²å¾—ã€Œ${riceball}ã€ï¼`;
      updateRolls();
      checkWin();
      showNextRiceball();
    }

    function computerWin(riceball) {
      if (!computerRolls.includes(riceball)) computerRolls.push(riceball);
      document.getElementById("resultText").textContent = `ä½ è¼¸äº†ï¼Œé›»è…¦ç²å¾—ã€Œ${riceball}ã€ï¼`;
      updateRolls();
      checkWin();
      showNextRiceball();
    }

    function checkWin() {
      const final = document.getElementById("finalResult");
      if (playerRolls.length === 5) {
        final.textContent = "ğŸ‰ WIN ğŸ‰";
        disableButtons(true);
        document.getElementById("restartBtn").style.display = "inline-block";
      } else if (computerRolls.length === 5) {
        final.textContent = "ğŸ˜¢ LOSE ğŸ˜¢";
        disableButtons(true);
        document.getElementById("restartBtn").style.display = "inline-block";
      } else {
        document.getElementById("finalResult").textContent = "";
      }
    }

    function resetGame() {
      playerRolls = [];
      computerRolls = [];
      currentRiceball = "";
      document.getElementById("playerHand").textContent = "âœŠ";
      document.getElementById("computerHand").textContent = "âœŠ";
      document.getElementById("resultText").textContent = "è«‹å‡ºæ‹³æˆ–ä½¿ç”¨æ…¢å‡ºæŠ€å·§";
      document.getElementById("finalResult").textContent = "";
      document.getElementById("restartBtn").style.display = "none";
      updateRolls();
      showNextRiceball();
      disableButtons(false);
      gameInProgress = false;
    }

    // åˆå§‹åŒ–
    updateRolls();
    showNextRiceball();
  </script>
</body>
</html>
